<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEA AI People Directory</title>
    <meta name="description" content="Interactive directory of AI professionals in Southeast Asia">
</head>
<body>
    <div id="loading">Loading people data...</div>
    <div id="app" class="hidden">
        <div id="filters-container"></div>
        <div id="people-container"></div>
        <div id="no-results" class="hidden">
            <div>
                <h3>No results found</h3>
                <button id="clear-filters-btn">Clear filters</button>
            </div>
        </div>
        <footer class="map-footer">
            <div class="source-attribution">
                Data source: <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vTRiNh4w92XdVXeRlBtrlSk9LcgFhLMNz97Ry0h34gfElPeZ4ZH-Kx_7CkjnYJfDmADti7sKO7cLExX/pub?gid=928970532&single=true&output=csv" target="_blank" rel="noopener">Google Sheets</a>
            </div>
            <div style="text-align: center; padding: 10px; color: #666; font-size: 12px;">
                Â© 2025 SEA AI People Directory
            </div>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    <script type="module" src="iframe-app.js"></script>
    <script>
    (function() {
        const postHeight = () => {
            const height = Math.max(
                document.body.scrollHeight,
                document.body.offsetHeight,
                document.documentElement.clientHeight,
                document.documentElement.scrollHeight,
                document.documentElement.offsetHeight
            );
            
            // Post to parent (WordPress iframe)
            if (window.parent !== window) {
                window.parent.postMessage({
                    type: 'sea-ai-people:height',
                    height: height
                }, '*');
            }
            
            // Post to Flutter WebView
            if (window.flutter_inappwebview) {
                window.flutter_inappwebview.callHandler('updateHeight', height);
            }
        };

        // Multiple triggers for height updates
        document.addEventListener('DOMContentLoaded', postHeight);
        window.addEventListener('load', postHeight);
        window.addEventListener('resize', postHeight);
        
        // Delayed updates for async content
        setTimeout(postHeight, 500);
        setTimeout(postHeight, 1500);
        
        // Watch for content changes
        if (window.ResizeObserver) {
            const ro = new ResizeObserver(postHeight);
            ro.observe(document.body);
        }
    })();
    </script>
</body>
</html>
